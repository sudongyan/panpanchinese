{extend name="base:common" /} {block name="css"}
<style>
	/*dialog*/
	
	.aui-dialog {
		width: 33.5rem;
		text-align: center;
		position: fixed;
		z-index: 999;
		left: 50%;
		margin-left: -16.75rem;
		margin-top: 0;
		top: 45%;
		border-radius: 0.3rem;
		border: 2px solid #dddddd;
		opacity: 0;
		background-color: #ffffff;
		-webkit-transform: translate3d(0, 0, 0) scale(1.2);
		transform: translate3d(0, 0, 0) scale(1.2);
		-webkit-transition-property: -webkit-transform, opacity;
		transition-property: transform, opacity;
		/*display: none;*/
	}
	
	.aui-dialog-header {
		padding: 0.5rem 0.75rem 0 0.75rem;
		text-align: center;
		font-size: 1.5em;
		color: #212121;
	}
	
	.aui-dialog-body {
		padding: 0.75rem;
		overflow: hidden;
		font-size: 1.1em;
		color: #757575;
	}
	
	.aui-dialog-body input {
		border: 1px solid #dddddd;
		height: 1.8rem;
		line-height: 1.8rem;
		min-height: 1.8rem;
		padding-left: 0.25rem;
		padding-right: 0.25rem;
	}
	
	.aui-dialog-footer {
		position: relative;
		font-size: 1em;
		border-top: 1px solid #dddddd;
		display: -webkit-box;
		display: -webkit-flex;
		display: flex;
		-webkit-box-pack: center;
		-webkit-justify-content: center;
		justify-content: center;
	}
	
	.aui-dialog-btn {
		position: relative;
		display: block;
		width: 100%;
		padding: 0 0.25rem;
		height: 3rem;
		font-size: 1.5rem;
		line-height: 3rem;
		text-align: center;
		color: #0894ec;
		border-right: 1px solid #dddddd;
		white-space: nowrap;
		text-overflow: ellipsis;
		overflow: hidden;
		-webkit-box-sizing: border-box;
		box-sizing: border-box;
		-webkit-box-flex: 1;
		box-flex: 1;
	}
	
	.aui-dialog-btn:last-child {
		border-right: none;
	}
	
	.aui-dialog.aui-dialog-in {
		opacity: 1;
		-webkit-transition-duration: 300ms;
		transition-duration: 300ms;
		-webkit-transform: translate3d(0, 0, 0) scale(1);
		transform: translate3d(0, 0, 0) scale(1);
	}
	
	.aui-dialog.aui-dialog-out {
		opacity: 0;
		-webkit-transition-duration: 300ms;
		transition-duration: 300ms;
		-webkit-transform: translate3d(0, 0, 0) scale(0.815);
		transform: translate3d(0, 0, 0) scale(0.815);
	}
	
	@media only screen and (-webkit-min-device-pixel-ratio: 1.5) {
		.aui-dialog-footer {
			border: none;
			background-size: 100% 1px;
			background-repeat: no-repeat;
			background-position: top;
			background-image: linear-gradient(0, #dddddd, #dddddd 50%, transparent 50%);
			background-image: -webkit-linear-gradient(90deg, #dddddd, #dddddd 50%, transparent 50%);
		}
		.aui-dialog-btn {
			border: none;
			background-image: -webkit-linear-gradient(0deg, #dddddd, #dddddd 50%, transparent 50%);
			background-image: linear-gradient(270deg, #dddddd, #dddddd 50%, transparent 50%);
			background-size: 1px 100%;
			background-repeat: no-repeat;
			background-position: right;
		}
		.aui-dialog-btn:last-child {
			border: none;
			background-size: 0 100%;
		}
		.aui-dialog-body input {
			border: none;
			background-image: -webkit-linear-gradient(270deg, #dddddd, #dddddd 50%, transparent 50%), -webkit-linear-gradient(180deg, #dddddd, #dddddd 50%, transparent 50%), -webkit-linear-gradient(90deg, #dddddd, #dddddd 50%, transparent 50%), -webkit-linear-gradient(0, #dddddd, #dddddd 50%, transparent 50%);
			background-image: linear-gradient(180deg, #dddddd, #dddddd 50%, transparent 50%), linear-gradient(270deg, #dddddd, #dddddd 50%, transparent 50%), linear-gradient(0deg, #dddddd, #dddddd 50%, transparent 50%), linear-gradient(90deg, #dddddd, #dddddd 50%, transparent 50%);
			background-size: 100% 1px, 1px 100%, 100% 1px, 1px 100%;
			background-repeat: no-repeat;
			background-position: top, right top, bottom, left top;
		}
	}
	/*toast*/
	
	.aui-toast {
		background: rgba(0, 0, 0, 0.7);
		text-align: center;
		border-radius: 0.25rem;
		color: #ffffff;
		position: fixed;
		z-index: 3;
		top: 45%;
		left: 50%;
		width: 7.5em;
		min-height: 6em;
		margin-left: -3.75em;
		margin-top: -4rem;
		display: none;
	}
	
	.aui-toast .aui-iconfont {
		margin-top: 0.2rem;
		display: block;
		font-size: 2.6rem;
	}
	
	.aui-toast-content {
		margin: 0 0 0.75rem;
	}
	
	.aui-toast-loading {
		background-color: #ffffff;
		border-radius: 100%;
		margin: 0.75rem 0;
		-webkit-animation-fill-mode: both;
		animation-fill-mode: both;
		border: 2px solid #ffffff;
		border-bottom-color: transparent;
		height: 2.25rem;
		width: 2.25rem;
		background: transparent !important;
		display: inline-block;
		-webkit-animation: rotate 1s 0s linear infinite;
		animation: rotate 1s 0s linear infinite;
	}
</style>
{/block} {block name="body"}
<div class="container" style="max-width: 400px;margin-top: 20px;">
	<div class="panel panel-default">
		<div class="panel-heading" style="background-color: #9981b4;text-align: center;color: #ffffff;">
			<h3 class="panel-title">{$Think.lang.pay_1}</h3></div>
		<div class="panel-body">
			<h4>{$Think.lang.pay_2}</h4>
			<div class="row">
				<div class="col-xs-4">
					<h5>{$Think.lang.my_index_8}</h5>
				</div>
				<div class="col-xs-8" style="text-align: right;">
					<h5>1{$Think.lang.my_index_9} 30{$Think.lang.my_index_6}，{$Think.lang.week_1_l}{$price.month}{$Think.lang.my_index_9}</h5>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-4">
					<h5>{$Think.lang.my_index_19}</h5>
				</div>
				<div class="col-xs-8" style="text-align: right;">
					<h5>{$price.the_start_time}~{$price.the_end_time}</h5>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-4">
					<h5>{$Think.lang.pay_3}</h5>
				</div>
				<div class="col-xs-8" style="text-align: right;">
					<h5>{$Think.lang.price_5}{$price.class}{$Think.lang.my_index_9}</h5>
				</div>
			</div>
			<div class="panel panel-default" style="background-color: #D4D4D4;">
				<div class="panel-body">
					<div class="row">
						<div class="col-xs-4">
							<h5>{$Think.lang.price_7}</h5>
						</div>
						<div class="col-xs-8" style="text-align: right;">
							<h5>{$price.themoney}{$type.currency}</h5>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-4">
							<h5>{$Think.lang.price_8}</h5>
						</div>
						<div class="col-xs-8" style="text-align: right;">
							<h5>{$price.discount}%{$Think.lang.price_29} <font style="color: red;">-{$price.thedmoney}{$type.currency}</font></h5>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-4">
							<h5>{$Think.lang.pay_4}</h5>
						</div>
						<div class="col-xs-8" style="text-align: right;">
							<h5 style="color: red;">-<font id="coupon_money">0</font>{$type.currency}</h5>
						</div>
					</div>
					<hr style="background-color: #000000;border: 0;border-bottom: 1px solid black;" />
					<div class="row">
						<div class="col-xs-4">
							<h5>{$Think.lang.price_9}</h5>
						</div>
						<div class="col-xs-8" style="text-align: right;">
							<h5><font id="allmoney2">{$price.paymoney}</font>{$type.currency}</h5>
						</div>
					</div>
				</div>
			</div>
			<h4>{$Think.lang.pay_5}</h4>
			<div class="panel panel-default" style="background-color: #D4D4D4;">
				<div class="panel-body">
					<div class="input-group">
						<input id="coupon" type="text" class="form-control" placeholder="{$Think.lang.pay_6}">
						<span class="input-group-btn">
        						<button onclick="coupon()" class="btn btn-danger" type="button">{$Think.lang.pay_7}</button>
      					</span>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-4">
					<h5>{$Think.lang.pay_8}</h5>
				</div>
				<div class="col-xs-8" style="text-align: right;">
					<h5>{$type.name}</h5>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-4">
					<h5>{$Think.lang.pay_9}</h5>
				</div>
				<div class="col-xs-8" style="text-align: right;">
					<h5><font id="allmoney">{$price.paymoney}</font>{$type.currency}</h5>
				</div>
			</div>
			{if condition="$thetype == 0"}
			<form method="post" action="{:url('pay/index')}">
				<input id="price_id" name="price_id" value="{$price.id}" type="hidden" />
				<input id="paytype" name="type" value="{$thetype}" type="hidden" />
				<input id="coupon_id" name="coupon_id" value="0" type="hidden" />
				<button type="submit" class="btn btn-purple btn-lg btn-block">{$Think.lang.pay_10}</button>
			</form>
			{elseif condition="$thetype == 1"}
			<button type="button" class="btn btn-purple btn-lg btn-block" data-toggle="modal" data-target="#zz">{$Think.lang.pay_10}</button>
			{elseif condition="$thetype == 2"}
			<form method="post" action="{:url('pay/wxindex')}">
				<input id="price_id" name="price_id" value="{$price.id}" type="hidden" />
				<input id="paytype" name="type" value="{$thetype}" type="hidden" />
				<input id="coupon_id" name="coupon_id" value="0" type="hidden" />
				<button type="submit" class="btn btn-purple btn-lg btn-block">{$Think.lang.pay_10}</button>
			</form>
			{elseif condition="$thetype == 3"}
			<form method="post" action="{:url('pay/kindex')}">
				<input id="price_id" name="price_id" value="{$price.id}" type="hidden" />
				<input id="paytype" name="type" value="{$thetype}" type="hidden" />
				<input id="coupon_id" name="coupon_id" value="0" type="hidden" />
				<button type="submit" class="btn btn-purple btn-lg btn-block">{$Think.lang.pay_10}</button>
			</form>
			{/if}
		</div>
	</div>
</div>
<div class="modal fade" id="zz" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-body">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<div class="panel-heading">
					<h3 class="panel-title" style="font-family: JejuGothic;">{$Think.lang.price_30}<br><h6 style="font-family: JejuGothic;">{$Think.lang.price_31}</h6></h3>
				</div>
				<p style="font-family: JejuGothic;">{$Think.lang.price_32}</p>
				<br />
				<strong>
					<ul class="list-group">
  						<li class="list-group-item" style="font-family: JejuGothic;color: #a4a4a4;">계좌정보</li>
  						<li class="list-group-item" style="font-family: JejuGothic;">기업은행</li>
  						<li class="list-group-item" style="font-family: JejuGothic;">93202851904011</li>
  						<li class="list-group-item" style="font-family: JejuGothic;">판판차이니즈</li>
					</ul>
    					</strong>
				<form id="zzform" class="form-horizontal" method="post" action="{:url('pay/index')}">
					<input id="typeinfo_price_id" value="{$price.id}" name="price_id" type="hidden" />
					<input name="type" value="1" type="hidden" />
					<input id="pay_coupon_id" name="coupon_id" value="0" type="hidden" />
					<div class="form-group">
						<label class="col-sm-4 control-label" style="font-family: JejuGothic;">{$Think.lang.price_33}</label>
						<div class="col-sm-8">
							<input type="text" class="form-control" id="allmoney3" value="{$price.paymoney}{$type.currency}" disabled>
						</div>
					</div>
					<div class="form-group" style="display: none;">
						<label class="col-sm-4 control-label" style="font-family: JejuGothic;">{$Think.lang.price_34}</label>
						<div class="col-sm-8">
							<input type="text" name="payer_info" class="form-control">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label" style="font-family: JejuGothic;">{$Think.lang.price_35}</label>
						<div class="col-sm-8">
							<input type="text" id="payer_name" name="payer_name" class="form-control" required="required">
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label"></label>
						<div class="col-sm-8">
							<button type="submit" class="btn btn-danger center-block" style="width: 150px;background-color: #a80000;" style="font-family: JejuGothic;">{$Think.lang.price_10}</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
{/block} {block name="script"}
<script>
	var coupondata;
	var thetype = {$thetype};
	var paymoney = {$price.paymoney};
	var currency = '{$type.currency}';
	function coupon() {
		var code = $('#coupon').val();
		if(code.length == 0 || code == '' || code == null) {
			alert('{$Think.lang.pay_11}');
			return false;
		}
		$.ajax({
			type: "GET",
			url: "{:url('pay/get_coupon')}",
			data: {
				type: thetype,
				paymoney: paymoney,
				code: code
			},
			datatype: "json",
			success: function(res) {
				if(res.result == true) {
					coupondata = res.data;
					if(thetype == 1 || thetype == 3){
						if(paymoney >= coupondata.min_money){
							$('#pay_coupon_id').val(coupondata.id);
							$('#coupon_id').val(coupondata.id);
							$('#coupon_money').html(coupondata.money);
							$('#allmoney').html(paymoney - coupondata.money);
							$('#allmoney2').html(paymoney - coupondata.money);
							$('#allmoney3').val((paymoney - coupondata.money) + currency);
						}else{
							alert('{$Think.lang.pay_12}');
						}
					}else if(thetype == 0){
						if(paymoney >= coupondata.min_usd_money){
							$('#coupon_id').val(coupondata.id);
							$('#coupon_money').html(coupondata.usd_money);
							$('#allmoney').html(paymoney - coupondata.usd_money);
							$('#allmoney2').html(paymoney - coupondata.usd_money);
						}else{
							alert('{$Think.lang.pay_12}');
						}
					}else{
						if(paymoney >= coupondata.min_cny_money){
							$('#coupon_id').val(coupondata.id);
							$('#coupon_money').html(coupondata.cny_money);
							$('#allmoney').html(paymoney - coupondata.cny_money);
							$('#allmoney2').html(paymoney - coupondata.cny_money);
						}else{
							alert('{$Think.lang.pay_12}');
						}
					}
				} else {
					alert('{$Think.lang.pay_13}');
				}
			},
			error: function() {
				alert("error");
			}
		});
	}
</script>
{/block}